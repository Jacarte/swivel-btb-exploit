# load native .so which contains code for copycode()
set $soaddr = (void*) dlopen("./copycode.so", 2)
add-symbol-file "./copycode.so" $soaddr

# get address of fread()
set $freadaddr = (char*) &'guest_func_fread'

# get address of target function
set $targetaddr = (void*)((uint64_t)$freadaddr ^ (1 << 25))

# call copycode with appropriate arguments
print (int) copycode($targetaddr, $freadaddr, 0x100)

# ensure result was 0
if $1 != 0
print "!!!!!!! Error performing copycode !!!!!!!"
end
